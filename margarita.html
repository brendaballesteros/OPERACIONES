<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infografía Interactiva Proyecto Margarita</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://kit.fontawesome.com/a7a72d325e.js" crossorigin="anonymous"></script>
    <!-- Se elimina la carga de Chart.js ya que el gráfico fue borrado -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fc;
            padding: 0; 
            min-height: 100vh;
        }

        /* Contenedor principal para aplicar el padding original */
        .main-content {
            padding: 20px;
            position: relative;
            z-index: 10;
        }
        
        /* BLOQUE DE CSS PARA EL FONDO CAÓTICO */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;

            /* Configuración de MÚLTIPLES IMÁGENES de fondo */
            background-image: url('https://i.imgur.com/jHNEtWW.png'),
                              url('https://i.imgur.com/jHNEtWW.png'),
                              url('https://i.imgur.com/jHNEtWW.png'),
                              url('https://i.imgur.com/jHNEtWW.png'),
                              url('https://i.imgur.com/jHNEtWW.png');
            
            /* Posiciones Aleatorias */
            background-position: 5% 10%, 90% 80%, 30% 50%, 75% 15%, 50% 95%;
            background-repeat: no-repeat;
            background-size: 100px auto, 150px auto, 80px auto, 120px auto, 70px auto;
            opacity: 0.8;
            transform: rotate(2deg);
        }

        /* ESTILOS DE LOS CONTADORES KPI */
        .kpi-card {
            background-color: #ffffff;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .kpi-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        /* ESTILOS PARA EMBEBIDO DE VIDEO RESPONSIVO */
        .video-responsive {
            overflow: hidden;
            padding-bottom: 56.25%; /* Relación de aspecto 16:9 */
            position: relative;
            height: 0;
        }
        .video-responsive iframe {
            left: 0;
            top: 0;
            height: 100%;
            width: 100%;
            position: absolute;
            border-radius: 0.75rem;
        }


        /* ESTILOS DEL MODAL (VENTANA EMERGENTE) */
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.75); /* Fondo oscuro semitransparente */
            display: none; /* Oculto por defecto */
            align-items: center;
            justify-content: center;
            z-index: 50; /* Z-index muy alto para estar sobre todo */
            padding: 20px;
        }

        .modal-content-wrapper {
            background-color: #ffffff;
            border-radius: 0.75rem;
            max-height: 90vh;
            overflow-y: auto; /* Permite desplazamiento si el contenido es largo */
            width: 100%;
            max-width: 1000px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Estilos de Tarjetas (concept-card) */
        .min-h-card-content {
            min-height: 250px; 
        }

        .concept-card {
            background-color: #ffffff;
            border-left: 5px solid; 
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
            position: relative; 
            z-index: 5;
        }
        /* Colores Danone */
        .bg-danone-blue { background-color: #005A9C; }
        .text-danone-blue { color: #005A9C; }
        .bg-danone-red { background-color: #E3001B; }
        .text-danone-red { color: #E3001B; }
        .bg-danone-dark-blue { background-color: #003366; } 

        .concept-card:nth-child(3n+1) { border-left-color: #136db0; }
        .concept-card:nth-child(3n+2) { border-left-color: #005A9C; }
        .concept-card:nth-child(3n+3) { border-left-color: #0c4670; }

        .concept-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        
        .bg-red-50 {
            background-color: #FEEBEB;
        }
    </style>
</head>
<body>

<div class="main-content container mx-auto">
    <header class="text-center mb-8 p-6 rounded-xl bg-danone-blue shadow-2xl">
        <h1 class="text-3xl sm:text-4xl font-extrabold text-white mb-2">
            Fundamentos de operaciones y calidad
        </h1>
        <p class="text-xl text-blue-200 mb-6">
            Conceptos clave detrás de estrategias sustentables - Proyecto Margarita
        </p>
        
        <div class="mt-4 flex justify-center">
            <img 
                src="https://i.imgur.com/CeuakR5.png" 
                alt="Logo Danone" 
                class="h-10 sm:h-12 w-auto p-1 bg-white rounded-lg"
            >
        </div>
    </header>

    <!-- ************************************ -->
    <!-- CONTADORES ANIMADOS DE IMPACTO -->
    <!-- ************************************ -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
        
        <!-- KPI 1: Productores Beneficiados -->
        <div class="kpi-card p-6 rounded-xl text-center border-b-4 border-danone-red">
            <i class="fas fa-users text-4xl text-danone-red mb-3"></i>
            <div id="kpi-producers" class="text-5xl font-extrabold text-gray-800" data-target="950" data-suffix="+">0</div>
            <p class="text-sm font-medium text-gray-500 mt-1">Productores Beneficiados</p>
        </div>

        <!-- KPI 2: Crecimiento de Ingresos -->
        <div class="kpi-card p-6 rounded-xl text-center border-b-4 border-danone-blue">
            <i class="fas fa-chart-line text-4xl text-danone-blue mb-3"></i>
            <div id="kpi-growth" class="text-5xl font-extrabold text-gray-800" data-target="300" data-suffix="%">0</div>
            <p class="text-sm font-medium text-gray-500 mt-1">Crecimiento de Ingresos</p>
        </div>

        <!-- KPI 3: Crédito Movilizado -->
        <div class="kpi-card p-6 rounded-xl text-center border-b-4 border-danone-red">
            <i class="fas fa-hand-holding-usd text-4xl text-danone-red mb-3"></i>
            <div id="kpi-credit" class="text-5xl font-extrabold text-gray-800" data-target="240" data-prefix="$" data-suffix="M">0</div>
            <p class="text-sm font-medium text-gray-500 mt-1">Crédito Movilizado (MXN)</p>
        </div>

    </div>

    <!-- LAS SOLAPAS AHORA SON BOTONES DE APERTURA DE MODAL -->
    <div class="space-y-8"> 

        <!-- SECCIÓN 1: Desarrollo Sostenible (BOTÓN ROJO) -->
        <button 
            data-modal-id="modal-sostenible" 
            data-title="Desarrollo sostenible"
            class="open-modal w-full p-4 sm:p-6 bg-danone-red text-white text-2xl font-bold rounded-xl transition duration-300 hover:opacity-90 flex justify-between items-center shadow-lg"
        >
            Desarrollo sostenible <i class="fas fa-leaf"></i>
        </button>

        <!-- SECCIÓN 2: Estrategia y Calidad (BOTÓN AZUL) -->
        <button 
            data-modal-id="modal-estrategia" 
            data-title="Estrategia y calidad"
            class="open-modal w-full p-4 sm:p-6 bg-danone-blue text-white text-2xl font-bold rounded-xl transition duration-300 hover:opacity-90 flex justify-between items-center shadow-lg"
        >
            Estrategia y calidad <i class="fas fa-bullseye"></i>
        </button>

        <!-- SECCIÓN 3: Mejora Continua y Control (BOTÓN AZUL OSCURO) -->
        <button 
            data-modal-id="modal-mejora" 
            data-title="Mejora continua y control"
            class="open-modal w-full p-4 sm:p-6 bg-danone-dark-blue text-white text-2xl font-bold rounded-xl transition duration-300 hover:opacity-90 flex justify-between items-center shadow-lg"
        >
            Mejora continua y control <i class="fas fa-redo-alt"></i>
        </button>

    </div>

    <!-- ************************************ -->
    <!-- VIDEO TESTIMONIAL REAL -->
    <!-- ************************************ -->
    <div class="mt-12 p-6 bg-white rounded-xl shadow-2xl">
        <h3 class="text-2xl font-bold text-danone-red mb-4 text-center">Testimonio Real del Impacto</h3>
        <p class="text-gray-600 mb-4 text-center">Mira la historia de Jaime Cortés, productor beneficiado por el Proyecto Margarita, y cómo cambió su vida y la de su familia.</p>
        <div class="video-responsive">
            <!-- Video de YouTube del Proyecto Margarita -->
            <iframe 
                src="https://www.youtube.com/embed/5wa-PZ2a9GI" 
                allowfullscreen 
                frameborder="0"
                title="Danone Ecosystem - The story of Jaime Cortés - Margarita project, Mexico">
            </iframe>
        </div>
    </div>


    <!-- SE ELIMINA EL ELEMENTO DE GRÁFICO DE BARRAS -->

    <footer class="text-center mt-10 text-gray-500 text-sm p-4 border-t border-gray-300">
        <p>Infografía generada con base en los contenidos de administración de operaciones i.</p>
    </footer>
</div>

<!-- ************************************ -->
<!-- CELDAS DE CONTENIDO OCULTO (MODAL DATA) -->
<!-- ************************************ -->

<!-- Contenido 1: Desarrollo Sostenible -->
<template id="modal-sostenible">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 p-6">
        <div class="concept-card p-5 rounded-lg border-l-4 border-danone-red min-h-card-content"> 
            <div class="text-danone-red text-3xl mb-3"><i class="fas fa-leaf"></i></div>
            <h3 class="font-bold text-xl mb-2">Desarrollo sostenible (informe brundtland)</h3>
            <p class="text-gray-600 text-sm">
                Aquel que garantiza las necesidades del presente sin comprometer las posibilidades de las generaciones futuras para satisfacer sus propias necesidades.
            </p>
            <div class="mt-4 p-3 bg-red-50 rounded-lg">
                <h4 class="text-sm font-semibold text-danone-red mb-1">ejemplo margarita (triple bottom line):</h4>
                <ul class="text-xs text-gray-600 space-y-1">
                    <li><i class="fas fa-seedling mr-1 text-danone-red"></i> <b>Social:</b> Eleva el nivel de vida y convierte a productores en microempresarios.</li>
                    <li><i class="fas fa-wallet mr-1 text-danone-red"></i> <b>Económico:</b> Genera un mercado estable y mayor rendimiento/ingresos.</li>
                </ul>
            </div>
        </div>
        <div class="concept-card p-5 rounded-lg border-l-4 border-danone-blue min-h-card-content"> 
            <div class="text-danone-blue text-3xl mb-3"><i class="fas fa-users-cog"></i></div>
            <h3 class="font-bold text-xl mb-2">Valor compartido (vc)</h3>
            <p class="text-gray-600 text-sm">
                Políticas y prácticas que mejoran la competitividad de una empresa a la vez que ayudan a mejorar las condiciones sociales en las comunidades donde opera.
            </p>
            <ul class="text-xs text-gray-500 mt-2 space-y-1">
                <li><b class="text-danone-red">Redefine productividad:</b> impulsar a productores a ser microempresarios (mejora social + eficiencia).</li>
                <li><b class="text-danone-red">Desarrollo del clúster:</b> alianzas con bid, technoserve, nuup, unam y unión ganadera.</li>
            </ul>
        </div>
        <div class="concept-card p-5 rounded-lg border-l-4 border-danone-red min-h-card-content">
            <div class="text-danone-red text-3xl mb-3"><i class="fas fa-recycle"></i></div>
            <h3 class="font-bold text-xl mb-2">Producción sustentable (ps)</h3>
            <p class="text-gray-600 text-sm">
                Modelo que minimiza el uso de recursos y la generación de residuos sin poner en riesgo a las generaciones futuras.
            </p>
            <ul class="text-xs text-gray-500 mt-2 space-y-1">
                <li><b class="text-danone-red">Principios clave:</b> aplicación de buenas prácticas y uso eficiente de recursos (ej. asistencia técnica para mejorar la infraestructura de los establos).</li>
            </ul>
        </div>
    </div>
</template>

<!-- Contenido 2: Estrategia y Calidad -->
<template id="modal-estrategia">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 p-6">
        <div class="concept-card p-5 rounded-lg border-l-4 border-danone-blue min-h-card-content">
            <div class="text-danone-blue text-3xl mb-3"><i class="fas fa-bullseye"></i></div>
            <h3 class="font-bold text-xl mb-2">Estrategia de operaciones</h3>
            <p class="text-gray-600 text-sm">
                Medio por el cual el área de operaciones implementa la estrategia corporativa, vinculando decisiones de corto/largo plazo.
            </p>
            <ul class="text-xs text-gray-500 mt-2 space-y-1">
                <li><b class="text-danone-red">Impulso:</b> doble proyecto y visión one planet, one health.</li>
                <li><b class="text-danone-red">Coordina:</b> procesos centrales (ej. relación con proveedores para el 25% del abasto total).</li>
            </ul>
        </div>
        <div class="concept-card p-5 rounded-lg border-l-4 border-danone-red min-h-card-content"> 
            <div class="text-danone-red text-3xl mb-3"><i class="fas fa-handshake"></i></div>
            <h3 class="font-bold text-xl mb-2">Proceso central: Relación con proveedores</h3>
            <p class="text-gray-600 text-sm">
                Proceso que afecta el flujo de materiales y la calidad del insumo.
            </p>
            <ul class="text-xs text-gray-500 mt-2 space-y-1">
                <li><b class="text-danone-red">Ejemplo:</b> acceso a un mercado estable y comercialización directa con danone.</li>
                <li><b class="text-danone-red">Capacidad:</b> asegura leche de alta calidad, impactando la <b>calidad consistente</b> del producto final.</li>
            </ul>
        </div>
        <div class="concept-card p-5 rounded-lg border-l-4 border-danone-blue min-h-card-content">
            <div class="text-danone-blue text-3xl mb-3"><i class="fas fa-chart-bar"></i></div>
            <h3 class="font-bold text-xl mb-2">Capacidad competitiva</h3>
            <p class="text-gray-600 text-sm">
                Dimensiones de costo, calidad, tiempo y flexibilidad que un proceso posee.
            </p>
            <ul class="text-xs text-gray-500 mt-2 space-y-1">
                <li><b class="text-danone-red">Operaciones de bajo costo:</b> se logran al eficientizar el proceso (mayor rendimiento de leche para el productor).</li>
                <li><b class="text-danone-red">Flexibilidad de volumen:</b> aumentar el 25% del abasto de leche total de danone.</li>
            </ul>
        </div>
    </div>
</template>

<!-- Contenido 3: Mejora Continua y Control -->
<template id="modal-mejora">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 p-6">
        <div class="concept-card p-5 rounded-lg border-l-4 border-danone-red min-h-card-content">
            <div class="text-danone-red text-3xl mb-3"><i class="fas fa-medal"></i></div>
            <h3 class="font-bold text-xl mb-2">Administración de la calidad total (TQM)</h3>
            <p class="text-gray-600 text-sm">
                Filosofía basada en 3 principios para alto desempeño: satisfacción del cliente, participación del empleado y <b>mejoramiento continuo</b>.
            </p>
            <ul class="text-xs text-gray-600 mt-2 space-y-1">
                <li><i class="fas fa-star mr-1 text-danone-red"></i> <b>Calidad consistente:</b> cumplir especificaciones de diseño de manera uniforme (ej. leche de alta calidad para yogur).</li>
            </ul>
        </div>
        <div class="concept-card p-5 rounded-lg border-l-4 border-danone-blue min-h-card-content">
            <div class="text-danone-blue text-3xl mb-3"><i class="fas fa-redo-alt"></i></div>
            <h3 class="font-bold text-xl mb-2">Mejoramiento continuo (kaizen)</h3>
            <p class="text-gray-600 text-sm">
                Búsqueda constante para mejorar los procesos, utilizando el ciclo planear-hacer-verificar-actuar (PHVA).
            </p>
            <ul class="text-xs text-gray-500 mt-2 space-y-1">
                <li><b class="text-danone-red">Capacitación:</b> asistencia técnica para la adopción de nuevas prácticas.</li>
                <li><b class="text-danone-red">Conversión:</b> medición de resultados (más leche) para estandarizar las prácticas (conversión a microempresario).</li>
            </ul>
        </div>
        <div class="concept-card p-5 rounded-lg border-l-4 border-danone-red min-h-card-content"> 
            <div class="text-danone-red text-3xl mb-3"><i class="fas fa-chart-line"></i></div>
            <h3 class="font-bold text-xl mb-2">Control estadístico de procesos (CEP)</h3>
            <p class="text-gray-600 text-sm">
                Aplicación de técnicas estadísticas para determinar si el resultado de un proceso concuerda con el deseado.
            </p>
            <div class="mt-4">
                <p class="text-xs font-semibold mb-1 text-danone-blue">Objetivo: reducir la variación</p>
                <ul class="text-xs text-gray-500 space-y-1">
                    <li><b class="text-danone-red">Causas asignables:</b> problemas específicos que afectan el rendimiento (ej. fallas de infraestructura que se corrigen con financiamiento).</li>
                </ul>
            </div>
        </div>
    </div>
</template>

<!-- ************************************ -->
<!-- MODAL (VENTANA EMERGENTE) -->
<!-- ************************************ -->
<div id="main-modal" class="modal-backdrop">
    <div class="modal-content-wrapper">
        <div class="p-4 sm:p-6 flex justify-between items-center bg-gray-100 border-b border-gray-300 rounded-t-lg">
            <h2 id="modal-title" class="text-2xl font-bold text-danone-blue"></h2>
            <button id="close-modal" class="text-gray-700 hover:text-danone-red transition duration-200">
                <i class="fas fa-times text-2xl"></i>
            </button>
        </div>
        <div id="modal-body">
            <!-- El contenido de las plantillas se insertará aquí -->
        </div>
    </div>
</div>


<script>
    // **********************************
    // 1. INICIALIZACIÓN DE CONTADORES KPI
    // **********************************
    // Nueva función de animación con Easing (desaceleración)
    function animateValue(obj, start, end, duration, prefix = '', suffix = '') {
        let startTimestamp = null;
        
        // Easing function: Cuártica (t^4) - Desaceleración mucho más fuerte al final.
        const easeOutQuart = t => 1 - Math.pow(1 - t, 4);

        const step = (timestamp) => {
            if (!startTimestamp) startTimestamp = timestamp;
            const elapsed = timestamp - startTimestamp;
            let progress = Math.min(elapsed / duration, 1);
            
            // Aplicar la desaceleración
            const easedProgress = easeOutQuart(progress); 

            // Calcular el valor actual usando el progreso desacelerado
            const currentValue = Math.floor(easedProgress * (end - start) + start);
            
            obj.innerHTML = prefix + currentValue.toLocaleString('es-MX') + suffix;
            
            if (progress < 1) {
                window.requestAnimationFrame(step);
            } else {
                // Asegurar que el valor final sea exacto
                obj.innerHTML = prefix + end.toLocaleString('es-MX') + suffix;
            }
        };
        window.requestAnimationFrame(step);
    }

    function setupKpiCounters() {
        document.querySelectorAll('.kpi-card div[data-target]').forEach(counter => {
            const target = parseInt(counter.getAttribute('data-target'));
            const prefix = counter.getAttribute('data-prefix') || '';
            const suffix = counter.getAttribute('data-suffix') || '';
            animateValue(counter, 0, target, 4000, prefix, suffix); // 4 segundos de animación para un mejor efecto
        });
    }


    // **********************************
    // 2. INICIALIZACIÓN DE MODAL
    // **********************************
    const modal = document.getElementById('main-modal');
    const modalTitle = document.getElementById('modal-title');
    const modalBody = document.getElementById('modal-body');
    const openButtons = document.querySelectorAll('.open-modal');
    const closeButton = document.getElementById('close-modal');

    function openModal(modalId, title) {
        const template = document.getElementById(modalId);
        if (template) {
            modalBody.innerHTML = '';
            const content = template.content.cloneNode(true);
            modalBody.appendChild(content);

            modalTitle.textContent = title;
            modal.style.display = 'flex'; // Mostrar el modal
            document.body.style.overflow = 'hidden'; // Evita el desplazamiento del fondo
        }
    }

    function closeModal() {
        modal.style.display = 'none';
        modalBody.innerHTML = ''; 
        document.body.style.overflow = ''; // Habilita el desplazamiento del fondo
    }

    // Event Listeners
    openButtons.forEach(button => {
        button.addEventListener('click', () => {
            const modalId = button.getAttribute('data-modal-id');
            const title = button.getAttribute('data-title');
            openModal(modalId, title);
        });
    });

    closeButton.addEventListener('click', closeModal);

    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            closeModal();
        }
    });

    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.style.display === 'flex') {
            closeModal();
        }
    });

    // **********************************
    // 3. INICIALIZACIÓN FINAL
    // **********************************
    document.addEventListener('DOMContentLoaded', () => {
        setupKpiCounters(); // Inicia la animación de los contadores con Easing
        // Se elimina la llamada a createImpactChart()
    });
</script>

</body>
</html>
